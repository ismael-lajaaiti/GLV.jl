<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Functional extinctions · GLV.jl</title><meta name="title" content="Functional extinctions · GLV.jl"/><meta property="og:title" content="Functional extinctions · GLV.jl"/><meta property="twitter:title" content="Functional extinctions · GLV.jl"/><meta name="description" content="Documentation for GLV.jl."/><meta property="og:description" content="Documentation for GLV.jl."/><meta property="twitter:description" content="Documentation for GLV.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">GLV.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../cavity/">The cavity method</a></li><li class="is-active"><a class="tocitem" href>Functional extinctions</a></li><li><a class="tocitem" href="../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Functional extinctions</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Functional extinctions</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/ismael-lajaaiti/GLV.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/ismael-lajaaiti/GLV.jl/blob/main/docs/src/functional-extinctions.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Functional-extinctions-in-ecological-communities"><a class="docs-heading-anchor" href="#Functional-extinctions-in-ecological-communities">Functional extinctions in ecological communities</a><a id="Functional-extinctions-in-ecological-communities-1"></a><a class="docs-heading-anchor-permalink" href="#Functional-extinctions-in-ecological-communities" title="Permalink"></a></h1><p>We can distinguish two types of species extinctions. First, numerical extinctions occur when the very last member of a species dies. Second, functional extinctions occur when the species is still present in the community, but is too rare to fulfill its function.</p><p>Following methods of (<a href="../references/#saterberg2013">Säterberg <em>et al.</em>, 2013</a>) we consider that a species goes functionall extinct when a decrease in its abundance results in the extinction of some other species in the community. Here a will consider plant communities, thus to decrease species abundances we decrease their carrying capacity.</p><pre><code class="language-julia hljs">using GLV
using LinearAlgebra
using Distributions
using CairoMakie
set_theme!(theme_minimal())

S = 30
mu, sigma = -1 / S, 0.2 / sqrt(S)
K_mean, K_std = 1, 0.3
c = rand(
    Community,
    S;
    A_ij = Normal(mu, sigma),
    K_i = Normal(K_mean, K_std),
    interaction = :core,
)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Community([-1.0 0.05815724497448786 … 0.1305605767110295 -0.09510565452856025; -0.049776268237773556 -1.0 … -0.03851728194871852 -0.04747057162831165; … ; -0.01785496248586437 -0.08264127019407738 … -1.0 -0.02623906160769574; -0.020524569053147326 -0.03394106334448237 … -0.011571724999010791 -1.0], [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0  …  1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0], [0.907468471466523, 0.632812515714502, 1.4867899511466642, 0.800328983794459, 0.7843921119927364, 0.9716174609632783, 1.0309768302638227, 0.9711922442065765, 1.214341554816291, 0.7849213919430656  …  1.0984739857641288, 0.7373105134977236, 0.706455114307523, 1.113251577016299, 1.1203096217280892, 1.0064407792583159, 1.6479538653122872, 1.0665144123304127, 0.5392694867961288, 0.41560717263877855])</code></pre><p>We can check that the community results in a stable equilibrium, by checking that all species have positive abundances.</p><pre><code class="language-julia hljs">all(abundance(c) .&gt; 0)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">true</code></pre><p>Now let&#39;s compute the ecologically effective population size (EEP) of each species, that is, the population size below which some other species in the community go extinct. For each species <span>$j$</span>, we want to find the smallest decrease in its growth rate that would result in the extinction of some other species <span>$i$</span>. It can be shown that this quantity writes</p><p class="math-container">\[\varepsilon_j = \min_i(-\frac{\hat{N}_i}{A^{-1}_{ij}} | \varepsilon_j &gt; 0)\]</p><p>Let&#39;s compute this quantity for species each species.</p><pre><code class="language-julia hljs">Neq = abundance(c)
epsilon = zeros(S)
for j = 1:S
    eps = -abundance(c) ./ inv(c.A)[:, j]
    epsilon[j] = minimum(eps[eps.&gt;0])
end
epsilon</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">30-element Vector{Float64}:
 0.4138667425246353
 0.28365770480572
 0.4135858117952113
 0.3552995079633918
 0.40793433833214177
 0.31844721406191534
 0.5097748824975618
 0.5982515433315945
 0.6144304298720797
 0.43318582588244675
 ⋮
 0.3394032139483821
 0.3579158593352306
 0.7900334100637144
 0.5438372470016027
 0.49466322414049774
 0.7065407469314409
 0.6292922985665027
 0.20982837973058094
 0.27137943792018804</code></pre><p>We now have the smallest derease in carrying capacity that would result in the extinction of a species. The species becoming extinct can be the focal species or some other species. In the first scenario, there is no functional extinction but solely a numerical extinction.</p><p>We can compute the ecologically effective population size (EEP) of each species, that is, the minimal population size below which some species go extinct. When there is no functional extinction, but a numerical extinction, the EEP size is equal to zero.</p><pre><code class="language-julia hljs">delta_N = Diagonal(inv(c.A)) * epsilon
N_EEP = Neq .+ delta_N</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">30-element Vector{Float64}:
 0.0
 0.0
 0.0
 0.0
 0.0
 0.0
 0.0
 0.0
 0.0
 0.0
 ⋮
 0.0
 0.0
 0.0
 0.0
 0.0
 0.0
 0.0
 0.0
 0.0</code></pre><p>We see that all species EEP size are zero. This is not suprising because we have set very weak interactions strengths. Thus, the species are not dependent on each other, and the decrease in abundance of one species has very little effect on the others.</p><p>Let&#39;s repeat our analysis with a stronger interaction matrix.</p><pre><code class="language-julia hljs">mu, sigma = -1 / S, 0.8 / sqrt(S)
K_mean, K_std = 1, 0.3
c = rand(
    Community,
    S;
    A_ij = Normal(mu, sigma),
    K_i = Normal(K_mean, K_std),
    interaction = :core,
)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Community([-1.0 -0.17931159336100375 … 0.013498139529239372 0.20186716384950187; -0.034404711368708304 -0.9999999999999999 … -0.3580151672356134 -0.13353808722367938; … ; -0.01654208797924357 -0.0601265273674959 … -0.9999999999999999 0.00506372509586414; 0.07846831076481696 0.07512248104504692 … -0.592448428913982 -0.9999999999999999], [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0  …  1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0], [1.43146629704904, 0.850615831187796, 0.5816234516549172, 1.6002595838784945, 1.0440346831913119, 1.5150942348373064, 1.4348800490109919, 0.8258365740132483, 1.2339543270947535, 1.0104190265672024  …  1.0942660286470918, 0.9565653477746833, 1.0360130768570217, 1.2358697542065868, 0.6163850811489825, 1.3517053248568207, 0.8981837523739566, 1.28818816432615, 0.3616015822719721, 0.9620453155467537])</code></pre><p>Because interactions are stronger, we expect some extinctions during the community assembly.</p><pre><code class="language-julia hljs">Neq = abundance(c)
all(Neq .&gt; 0)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">false</code></pre><p>So let&#39;s assemble the community, and keep only the surviving species. This can be done simply by calling the <a href="../#GLV.assemble-Tuple{Community}"><code>assemble</code></a> function that is been designed precisely for this purpose.</p><pre><code class="language-julia hljs">c_new = assemble(c)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Community([-1.0 -0.17931159336100375 … 0.07668495521827527 -0.18433879841960105; -0.034404711368708304 -0.9999999999999999 … 0.020668637462469126 -0.11927286453195049; … ; 0.11987520977924622 -0.19098149747135496 … -0.9999999999999999 -0.0208967214913454; 0.167959221541016 -0.1367694439580734 … -0.42580151024045243 -1.0], [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0  …  1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0], [1.43146629704904, 0.850615831187796, 0.5816234516549172, 1.6002595838784945, 1.0440346831913119, 1.5150942348373064, 1.4348800490109919, 0.8258365740132483, 1.2339543270947535, 1.0104190265672024  …  1.318502949519112, 0.889302662238364, 1.5378013313719776, 1.1062738397204963, 1.1527599726214273, 0.9565653477746833, 1.0360130768570217, 0.6163850811489825, 0.8981837523739566, 1.28818816432615])</code></pre><p>We can check that some species have gone extinct during the assembly.</p><pre><code class="language-julia hljs">S_new = richness(c_new) # Smaller than the initial richness S.</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">24</code></pre><pre><code class="language-julia hljs">epsilon = zeros(S_new)
for j = 1:S_new
    eps = -abundance(c_new) ./ inv(c_new.A)[:, j]
    epsilon[j] = minimum(eps[eps.&gt;0])
end
delta_N = Diagonal(inv(c_new.A)) * epsilon
Neq = abundance(c_new)
N_EEP = Neq .+ delta_N</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">24-element Vector{Float64}:
  0.523950662162657
  0.30318250338850733
  0.16121393024365702
  0.0
 -6.938893903907228e-18
  0.0
  1.1186405630716352
  0.0
  1.116791533033259
  0.0
  ⋮
  0.9372781504899901
  0.8136424573532159
  0.0
  0.0
  0.0
  1.1102230246251565e-16
  0.020049979420488542
  0.6621220381084492
  0.9662475569373428</code></pre><p>We see that all EEP sizes are not zeros. This means that some species are functionally necessary for the communtiy.</p><p>Finally, we can plot the EEP size of each species against their initial equilibrium abundance.</p><pre><code class="language-julia hljs">fig = Figure();
ax = Axis(fig[1, 1]; xlabel = &quot;Equilibrium abundance&quot;, ylabel = &quot;EEP size&quot;)
positive_eep = N_EEP .&gt; 0
scatter!(Neq[positive_eep], N_EEP[positive_eep])
fig</code></pre><img src="d2c78898.png" alt="Example block output"/><p>We note a stong positive trend, that is, the more abundant the species the larger its EEP size therefore the more &quot;quickly&quot; it goes functionally extinct.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../cavity/">« The cavity method</a><a class="docs-footer-nextpage" href="../references/">References »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.6.0 on <span class="colophon-date" title="Friday 6 September 2024 15:38">Friday 6 September 2024</span>. Using Julia version 1.10.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
